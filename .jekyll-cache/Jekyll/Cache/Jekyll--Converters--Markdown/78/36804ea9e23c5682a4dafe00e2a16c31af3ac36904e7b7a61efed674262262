I"2<p>إلى وقت قريب لم تكن توجد طريقة رسمية لإضافة الخطوط المخصصة لتطبيقات أندرويد، فقط بضعة حلول قام بابتكارها المجتمع لحل تلك المشلكة، أهما:</p>
<h3 id="العناصر-المُعدلة---custom-views">العناصر المُعدلة - custom views</h3>
<p>في هذه الطريقة، كل ما عليك هو أن تقوم بكتابة عنصر خاص لاستبدال خطوط النظام، فإذا كنت تريد تغيير عنصر الزر مثلًا، فستقوم ببناء عنصر جديد يرث من العنصر Button، وتقوم بكتابة الكود المسؤول عن إضافة خطوطك الخاصة. الكود التالي يوضح كيفية تحديد خط العنصر، وهذا بعد إضافة الخطوط التي تريد في المسار  <strong>assets</strong>. أو في المسار <strong>assets/fonts</strong> لتنظيم الأمر قليلًا.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Typeface</span> <span class="n">tf</span> <span class="o">=</span> <span class="nc">Typeface</span><span class="o">.</span><span class="na">createFromAsset</span><span class="o">(</span><span class="n">getContext</span><span class="o">().</span><span class="na">getAssets</span><span class="o">(),</span> <span class="s">"assets/"</span> <span class="o">+</span> <span class="n">fontName</span><span class="o">;</span>
<span class="n">setTypeface</span><span class="o">(</span><span class="n">tf</span><span class="o">);</span>
</code></pre></div></div>
<h3 id="مكتبة-calligraphy">مكتبة Calligraphy</h3>
<p>توجد عدة مكتبات مشهورة للقيام بهذا الأمر، فمشكلة الطريقة السابقة، أن أي عنصر View تريد استبدال خطوطه، سيتوجب عليك بناء عنصر جديد يرث منه خصائصه، ثم تخصيص الخطوط التي تريد إضافتها. لذا فالمكتبة تعتبر حل سريع وعملي للقيام بالأمر، أشهر مكتبة هي <a href="https://github.com/chrisjenx/Calligraphy">Calligraphy</a>.</p>

<p>في مؤتمر Google IO الأخير أعلن فريق تطوير أندرويد عن العديد من المميزات الجديدة في مكتبة الدعم الإصدار 26، من أهمها إمكانية تخصيص الخطوط، وبما أن هذه الميزة تأتي مع مكتبة الدعم، فإن الإصدارات القديمة من أندرويد لن تجد مشكلة في إظهار هذه الخطوط.</p>

<h3 id="كيفية-استخدام-الخطوط-المخصصة-مع-مكتبة-الدعم-support-library-26">كيفية استخدام الخطوط المخصصة مع مكتبة الدعم Support library 26</h3>

<p>لتطبيق الأمر عمليًا قمت بتحميل نموذج لشاشة تسجيل ودخول موجودة مسبقًا وتستخدم الطريقة القديمة في تخصيص الخطوط، <a href="https://www.uplabs.com/posts/login-signup-ui-kit">رابط عرض وتحميل النموذج</a>. بعد تعديل ملفات Gradle وتحديث إصدار مكتبة الدعم، ثم بناء التطبيق تظهر الصورة التالية موضحة الخطوط المستخدمة في النموذج Sample.</p>

<p><img src="/images/posts/2017-10-23-custom-fonts-android/Screenshot_20171023-175232.png" alt="custom fonts Android support library 1" title="custom fonts Android support library" height="450" /></p>

<p><strong>الآن سنتبع <a href="https://developer.android.com/guide/topics/ui/look-and-feel/fonts-in-xml.html#using-support-lib">خطوات</a>  استخدام مكتبة الدعم ..</strong></p>

<ul>
  <li>بعد ضغط يمين الماوس على فولدر res ستظهر القائمة لنختار منها New ثم Android resource directory ومن ثم نختار نوع الفولدر font.</li>
  <li>بعد إنشاء هذا الفولدر، سننقل ملفات الخطوط الموجودة في المسار assets/fonts لمسارها الجديد والمعتمد الآن res/font. إذا كنت تستخدم نسخة أندرويد ستوديو 3.0.0 التجريبية فيمكنك الضغط على ملف الخط لاستعراضه .. اشكرني لاحقًا.</li>
  <li>والأن سنقوم بإنشاء font family  وهي تعريف مجموعة من الخطوط وطريقة العرض لكي يتعرف عليها النظام. نضغط على فولدر font ثم New وأخيرًا Font resource file.</li>
  <li>ثم نضيف الكود التالي ..</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;font-family xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"&gt;

&lt;!--regular--&gt;
&lt;font
      android:font="@font/MavenPro_Regular"
      android:fontStyle="normal"
      android:fontWeight="400"
      
      app:font="@font/MavenPro_Regular"
      app:fontStyle="normal"
      app:fontWeight="400" /&gt;

  &lt;!-- italic --&gt;
  &lt;font

      android:font="@font/MavenPro_Regular"
      android:fontStyle="italic"
      android:fontWeight="400"
      
      app:font="@font/MavenPro_Regular"
      app:fontStyle="italic"
      app:fontWeight="400" /&gt;

  &lt;!-- bold --&gt;
  &lt;font
      android:font="@font/MavenPro_Bold"
      android:fontStyle="normal"
      android:fontWeight="700"
      
      app:font="@font/MavenPro_Bold"
      app:fontStyle="normal"
      app:fontWeight="700" /&gt;


&lt;/font-family&gt;
</code></pre></div></div>

<p><strong>ملحوظة:</strong> يجب إعادة كتابة السطور باستخدام attribute <strong>app</strong> لضمان دعم الإصدارات الأقدم من النظام.</p>

<p>الآن يمكننا استخدام هذه الخطوط برمجيًا أو عبر ملفات xml ..</p>

<p><strong>استخدامها برمجيًا</strong><br />
لا تختلف طريقة استخدام الخطوط برمجيًا عن الطريقة القديمة، الفرق أنك تجدها عبر R.font ، وتحصل عليها عبر <strong>ResourcesCompat</strong>  وعلى سبيل التجربة سنقوم بتغيير تخصيص الخطوط في العناصر المعدلة في النموذج الذي بين أيدينا. تجدها في الفولدر customfonts.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(!</span><span class="n">isInEditMode</span><span class="o">())</span> <span class="o">{</span>
 	<span class="nc">Typeface</span> <span class="n">tf</span> <span class="o">=</span> <span class="nc">ResourcesCompat</span><span class="o">.</span><span class="na">getFont</span><span class="o">(</span><span class="n">getContext</span><span class="o">(),</span> <span class="no">R</span><span class="o">.</span><span class="na">font</span><span class="o">.</span><span class="na">app_font</span><span class="o">);</span>
 	<span class="n">setTypeface</span><span class="o">(</span><span class="n">tf</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>إذا قمنا بتشغيل التطبيق الآن، مفترض أن لا شيء سيتغير. لأننا نستخدم نفس الخطوط، المختلف فقط الطريقة.</p>

<p><strong>استخدامها عبر ملفات Xml</strong><br />
يمكننا استخدامها عبر attribute <strong>fontFamily</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app:fontFamily="@font/app_font"
</code></pre></div></div>
<p>ولذلك سنقوم بتغيير custom views الموجودة في ملفات xml إلى عناصر النظام أو مكتبة الدعم، وتطبيق السطر السابق، ثم تشغيل التطبيق مرة أخرى. 
كما يمكنك استخدام app أو android للتعريف، لكن  <strong>android:fontFamily</strong> غير متاحة حتى api 16، قبل ذلك يمكنك استخدام <strong>app:fontFamily</strong>. ربما تجد lint warning لكن لا بأس .. فالتعريف صحيح. بعد تطبيق الخطوط في ملفات xml لا حاجة لنا في العناصر المعدلة الموجودة في customfonts ويمكننا حذفها.</p>

<p><strong>استخدامها عبر  ملف style</strong><br />
يمكننا كذلك استخدامها عبر ملف style لتعريف كالآتي</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">style</span> <span class="n">name</span><span class="o">=</span><span class="s">"TextAppearance"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">item</span> <span class="n">name</span><span class="o">=</span><span class="s">"fontFamily"</span><span class="o">&gt;</span><span class="nd">@font</span><span class="o">/</span><span class="n">app_font</span><span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</code></pre></div></div>
<p>أخيرًا قد تريد تغيير كل الخطوط بالتطبيق لهذه الخطوط مرة واحدة، بدون التعديل على عنصر واجهة معين .. يمكنك ذلك عبر تحديد fontFamily في ثيم التطبيق عبر ملف style كالتالي:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;!--</span> <span class="nc">Base</span> <span class="n">application</span> <span class="n">theme</span><span class="o">.</span> <span class="o">--&gt;</span>
  <span class="o">&lt;</span><span class="n">style</span> <span class="n">name</span><span class="o">=</span><span class="s">"AppTheme"</span> <span class="n">parent</span><span class="o">=</span><span class="s">"Theme.AppCompat.Light.NoActionBar"</span><span class="o">&gt;</span>
    <span class="o">&lt;!--</span> <span class="nc">Customize</span> <span class="n">your</span> <span class="n">theme</span> <span class="n">here</span><span class="o">.</span> <span class="o">--&gt;</span>
    <span class="o">&lt;</span><span class="n">item</span> <span class="n">name</span><span class="o">=</span><span class="s">"colorPrimary"</span><span class="o">&gt;</span><span class="nd">@color</span><span class="o">/</span><span class="n">colorPrimary</span><span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">item</span> <span class="n">name</span><span class="o">=</span><span class="s">"colorPrimaryDark"</span><span class="o">&gt;</span><span class="nd">@color</span><span class="o">/</span><span class="n">colorPrimaryDark</span><span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">item</span> <span class="n">name</span><span class="o">=</span><span class="s">"colorAccent"</span><span class="o">&gt;</span><span class="nd">@color</span><span class="o">/</span><span class="n">colorAccent</span><span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">item</span> <span class="n">name</span><span class="o">=</span><span class="s">"android:fontFamily"</span><span class="o">&gt;</span><span class="nd">@font</span><span class="o">/</span><span class="n">font_family_roboto</span><span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</code></pre></div></div>

<p><strong>يمكنك إيجاد النموذج عبر <a href="https://github.com/MohamedISoliman/Custom-fonts-supportLib-26">github</a> ، ومراجعة الخطوات السابقة عبر التنقل بين الـ <a href="https://github.com/MohamedISoliman/Custom-fonts-supportLib-26/commits/master">commits</a></strong></p>

<p>مصادر:</p>

<p><a href="https://developer.android.com/guide/topics/ui/look-and-feel/fonts-in-xml.html">https://developer.android.com/guide/topics/ui/look-and-feel/fonts-in-xml.html</a><br />
<a href="https://segunfamisa.com/posts/custom-fonts-with-android-support-library">https://segunfamisa.com/posts/custom-fonts-with-android-support-library</a></p>

:ET